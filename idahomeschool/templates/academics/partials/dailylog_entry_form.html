<!-- Daily Log Entry Form -->
<form method="post" action="{% url 'academics:dailylog_entry_date' student.pk entry_date|date:'Y-m-d' %}" class="form grid gap-4">
  {% csrf_token %}

  <div class="card">
    <header>
      <h5 class="text-base font-semibold">Attendance for {{ student.name }}</h5>
      <p class="text-muted-foreground text-sm">{{ entry_date|date:"l, F j, Y" }}</p>
    </header>
    <section>
      <div class="grid gap-4">
        <div class="grid gap-2">
          <label for="status" class="text-sm font-semibold">Status *</label>
          <select name="status" id="status" required>
            {% for status in attendance_statuses %}
            <option value="{{ status.code }}" {% if daily_log and daily_log.attendance_status and daily_log.attendance_status.code == status.code or not daily_log and status.is_default %}selected{% endif %}>
              {{ status.label }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="grid gap-2">
          <label for="general_notes" class="text-sm font-semibold">General Notes *</label>
          <textarea name="general_notes" id="general_notes" rows="3" placeholder="Optional notes about the day...">{% if daily_log %}{{ daily_log.general_notes }}{% endif %}</textarea>
        </div>
      </div>
    </section>
  </div>

  <!-- Course Notes -->
  {% if course_notes_data %}
  <div class="card">
    <header>
      <div class="flex flex-col gap-1">
        <h5 class="text-base font-semibold">Course Notes</h5>
      </div>
    </header>
    <section>
      <div class="grid gap-4">
        {% for item in course_notes_data %}
        <div class="grid gap-2">
          <label for="course_notes_{{ item.enrollment.id }}" class="text-sm font-semibold">
            {{ item.enrollment.course.name }}
          </label>
          <textarea
            name="course_notes_{{ item.enrollment.id }}"
            id="course_notes_{{ item.enrollment.id }}"
            rows="3"
          >{{ item.notes_text }}</textarea>
        </div>
        {% endfor %}
      </div>
    </section>
  </div>
  {% else %}
  <div class="rounded-lg p-3 border bg-muted text-muted-foreground border-border">
    <strong>No courses found.</strong> Add courses for {{ student.name }} to track course notes.
    <a href="{% url 'academics:course_create' %}" class="link">Add Course</a>
  </div>
  {% endif %}

  <!-- Form Actions -->
  <div class="flex justify-between items-center">
    <a href="{% url 'academics:attendance_calendar' %}" class="btn-outline">Cancel</a>
    <button type="submit" class="btn">Save Daily Log</button>
  </div>
</form>
