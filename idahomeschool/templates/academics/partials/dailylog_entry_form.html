<!-- Daily Log Entry Form -->
<div class="border rounded-lg overflow-hidden bg-background">
  <div class="p-4 border-b bg-muted/30">
    <h2 class="text-lg font-semibold">Attendance for {{ student.name }}</h2>
    <p class="text-sm text-muted-foreground mt-1">{{ entry_date|date:"l, F j, Y" }}</p>
  </div>
  <div class="p-4">
    <form method="post" action="{% url 'academics:dailylog_entry_date' student.pk entry_date|date:'Y-m-d' %}" class="form space-y-6">
      {% csrf_token %}

      <!-- Attendance Section -->
      <div class="space-y-4">
        <div class="grid gap-2">
          <label for="status" class="text-sm font-medium">Attendance Status</label>
          <select name="status" id="status" required>
            {% for status in attendance_statuses %}
            <option value="{{ status.code }}" {% if daily_log and daily_log.attendance_status and daily_log.attendance_status.code == status.code or not daily_log and status.is_default %}selected{% endif %}>
              {{ status.label }}
            </option>
            {% endfor %}
          </select>
        </div>

        <div class="grid gap-2">
          <label for="general_notes" class="text-sm font-medium">General Notes</label>
          <textarea name="general_notes" id="general_notes" rows="3" placeholder="Optional notes about the day...">{% if daily_log %}{{ daily_log.general_notes }}{% endif %}</textarea>
        </div>
      </div>

      {% if course_notes_data %}
      <!-- Course Notes Section -->
      <div class="space-y-4 pt-4 border-t">
        <h3 class="text-sm font-semibold text-muted-foreground uppercase tracking-wide">Course Notes</h3>

        {% for item in course_notes_data %}
        <div class="grid gap-2">
          <label for="course_notes_{{ item.enrollment.id }}" class="text-sm font-medium">
            {{ item.enrollment.course.name }}
          </label>
          <textarea
            name="course_notes_{{ item.enrollment.id }}"
            id="course_notes_{{ item.enrollment.id }}"
            rows="3"
            placeholder="Notes for {{ item.enrollment.course.name }}..."
          >{{ item.notes_text }}</textarea>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="rounded-md border border-dashed border-border p-4 text-sm text-muted-foreground">
        <p class="font-medium text-foreground mb-1">No courses found</p>
        <p>Add courses for {{ student.name }} to track course-specific notes.
          <a href="{% url 'academics:course_create' %}" class="link">Add Course</a>
        </p>
      </div>
      {% endif %}

      <!-- Form Actions -->
      <div class="flex items-center justify-between pt-4">
        <a href="{% url 'academics:attendance_calendar' %}" class="btn-outline">Cancel</a>
        <button type="submit" class="btn">Save Daily Log</button>
      </div>
    </form>
  </div>
</div>
