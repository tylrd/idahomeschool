{% comment %}
Partial template for a single attendance status badge with HTMX attributes
Variables expected:
- student: Student object
- date_str: Date as string (Y-m-d format)
- log: DailyLog object (can be None)
- has_notes: Boolean indicating if course notes exist
{% endcomment %}

<div id="cell-{{ student.id }}-{{ date_str }}" class="inline-flex items-center gap-1">
  {% if log and log.attendance_status %}
    <button type="button"
            class="relative inline-flex items-center justify-center gap-1 size-9 rounded-full text-sm font-bold transition-all hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-1 cursor-pointer border-2"
            hx-get="{% url 'academics:attendance_quick_toggle' student.id date_str %}"
            hx-target="#status-selector-container"
            hx-swap="innerHTML"
            style="background-color: {{ log.attendance_status.color }}; border-color: {{ log.attendance_status.color }}; {% if log.attendance_status.color|slice:':4' == '#ffc' or log.attendance_status.color|slice:':4' == '#ff0' or log.attendance_status.color|slice:':4' == '#fff' %}color: #000;{% else %}color: #fff;{% endif %}"
            title="{{ log.attendance_status.label }} - Click to change">
      <span>{{ log.attendance_status.abbreviation }}</span>
      {% if has_notes %}
        <i data-lucide="book-text" class="size-2.5 opacity-80 absolute -top-0.5 -right-0.5"></i>
        <span class="sr-only">Has notes</span>
      {% endif %}
    </button>
  {% else %}
    <button type="button"
            class="inline-flex items-center justify-center size-9 rounded-full text-sm font-semibold border-2 border-muted-foreground/30 text-muted-foreground hover:border-muted-foreground/50 hover:bg-muted/50 transition-all focus:outline-none focus:ring-2 focus:ring-offset-1 cursor-pointer"
            hx-get="{% url 'academics:attendance_quick_toggle' student.id date_str %}"
            hx-target="#status-selector-container"
            hx-swap="innerHTML"
            title="No log - Click to add">
      <i data-lucide="plus-circle" class="size-4"></i>
    </button>
  {% endif %}

  {% comment %}
  Note icon for adding/viewing course notes - compact icon button
  {% endcomment %}
  <button type="button"
          class="inline-flex items-center justify-center size-6 rounded-full text-muted-foreground/60 hover:text-muted-foreground hover:bg-muted/50 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1"
          hx-get="{% url 'academics:attendance_course_notes' student.id date_str %}"
          hx-target="#course-notes-modal-container"
          hx-swap="innerHTML"
          onclick="document.getElementById('status-selector-container').innerHTML = '';"
          title="Add/view course notes">
    <i data-lucide="book" class="size-3.5"></i>
    <span class="sr-only">Add/view course notes</span>
  </button>
</div>
