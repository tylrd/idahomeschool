{% extends "academics/base.html" %}
{% load static %}

{% block title %}Attendance Statuses{% endblock %}

{% block academics_content %}
<div class="flex justify-between items-center mb-4">
  <h1 class="text-3xl font-bold">Attendance Statuses</h1>
  <a href="{% url 'academics:attendance_status_create' %}" class="btn-primary">
    <i class="bi bi-plus-circle"></i> Add Status
  </a>
</div>

<div class="alert mb-4">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="10" />
    <line x1="12" x2="12" y1="8" y2="12" />
    <line x1="12" x2="12.01" y1="16" y2="16" />
  </svg>
  <h2><i class="bi bi-info-circle"></i> About Attendance Statuses:</h2>
  <section>Customize the statuses used in your attendance calendar. You can change colors, labels, and create new statuses that fit your homeschooling needs.</section>
</div>

{% if statuses %}
<div class="card">
  <section>
    <div class="relative w-full overflow-x-auto">
      <table class="table">
        <thead>
          <tr>
            <th style="width: 60px;">Preview</th>
            <th>Code</th>
            <th>Label</th>
            <th>Abbreviation</th>
            <th>Color</th>
            <th>Instructional</th>
            <th>Default</th>
            <th style="width: 200px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for status in statuses %}
          <tr>
            <td>
              <span class="badge min-w-[40px] px-2 py-2" style="background-color: {{ status.color }}; {% if status.color|slice:':4' == '#ffc' or status.color|slice:':4' == '#ff0' or status.color|slice:':4' == '#fff' %}color: #000;{% endif %}">
                {{ status.abbreviation }}
              </span>
            </td>
            <td><code class="text-sm">{{ status.code }}</code></td>
            <td>{{ status.label }}</td>
            <td class="text-center">{{ status.abbreviation }}</td>
            <td>
              <div class="flex items-center">
                <div class="border rounded mr-2" style="width: 30px; height: 30px; background-color: {{ status.color }};"></div>
                <code class="text-sm">{{ status.color }}</code>
              </div>
            </td>
            <td class="text-center">
              {% if status.is_instructional %}
                <i class="bi bi-check-circle-fill text-green-600"></i>
              {% else %}
                <i class="bi bi-x-circle text-muted-foreground"></i>
              {% endif %}
            </td>
            <td class="text-center">
              {% if status.is_default %}
                <span class="badge">Default</span>
              {% else %}
                -
              {% endif %}
            </td>
            <td>
              <div class="flex gap-2">
                <a href="{% url 'academics:attendance_status_update' status.pk %}" class="btn-sm-outline">
                  <i class="bi bi-pencil"></i> Edit
                </a>
                <a href="{% url 'academics:attendance_status_delete' status.pk %}" class="btn-sm-outline text-destructive hover:bg-destructive hover:text-destructive-foreground">
                  <i class="bi bi-trash"></i> Delete
                </a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
</div>
{% else %}
<div class="alert-destructive">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3" />
    <path d="M12 9v4" />
    <path d="M12 17h.01" />
  </svg>
  <h2>No attendance statuses</h2>
  <section>
    <p>You don't have any attendance statuses configured yet. This shouldn't happen as default statuses are created automatically.</p>
    <a href="{% url 'academics:attendance_status_create' %}" class="btn-primary mt-3">Add First Status</a>
  </section>
</div>
{% endif %}

<div class="mt-4">
  <a href="{% url 'academics:attendance_calendar' %}" class="btn-outline">
    <i class="bi bi-arrow-left"></i> Back to Calendar
  </a>
</div>

{% endblock academics_content %}
