{% extends "academics/base.html" %}
{% load static %}

{% block title %}Attendance Statuses{% endblock %}

{% block academics_content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Attendance Statuses</h1>
  <a href="{% url 'academics:attendance_status_create' %}" class="btn btn-success">
    <i class="bi bi-plus-circle"></i> Add Status
  </a>
</div>

<div class="alert alert-info">
  <i class="bi bi-info-circle"></i>
  <strong>About Attendance Statuses:</strong> Customize the statuses used in your attendance calendar. You can change colors, labels, and create new statuses that fit your homeschooling needs.
</div>

{% if statuses %}
<div class="card">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead>
          <tr>
            <th style="width: 60px;">Preview</th>
            <th>Code</th>
            <th>Label</th>
            <th>Abbreviation</th>
            <th>Color</th>
            <th>Instructional</th>
            <th>Default</th>
            <th style="width: 200px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for status in statuses %}
          <tr>
            <td>
              <span class="badge" style="background-color: {{ status.color }}; {% if status.color|slice:':4' == '#ffc' or status.color|slice:':4' == '#ff0' or status.color|slice:':4' == '#fff' %}color: #000;{% endif %} min-width: 40px; padding: 8px;">
                {{ status.abbreviation }}
              </span>
            </td>
            <td><code>{{ status.code }}</code></td>
            <td>{{ status.label }}</td>
            <td class="text-center">{{ status.abbreviation }}</td>
            <td>
              <div class="d-flex align-items-center">
                <div style="width: 30px; height: 30px; background-color: {{ status.color }}; border: 1px solid #dee2e6; border-radius: 4px; margin-right: 8px;"></div>
                <code>{{ status.color }}</code>
              </div>
            </td>
            <td class="text-center">
              {% if status.is_instructional %}
                <i class="bi bi-check-circle-fill text-success"></i>
              {% else %}
                <i class="bi bi-x-circle text-muted"></i>
              {% endif %}
            </td>
            <td class="text-center">
              {% if status.is_default %}
                <span class="badge bg-primary">Default</span>
              {% else %}
                -
              {% endif %}
            </td>
            <td>
              <div class="btn-group btn-group-sm" role="group">
                <a href="{% url 'academics:attendance_status_update' status.pk %}" class="btn btn-outline-primary">
                  <i class="bi bi-pencil"></i> Edit
                </a>
                <a href="{% url 'academics:attendance_status_delete' status.pk %}" class="btn btn-outline-danger">
                  <i class="bi bi-trash"></i> Delete
                </a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% else %}
<div class="alert alert-warning">
  <h4>No attendance statuses</h4>
  <p>You don't have any attendance statuses configured yet. This shouldn't happen as default statuses are created automatically.</p>
  <a href="{% url 'academics:attendance_status_create' %}" class="btn btn-primary">Add First Status</a>
</div>
{% endif %}

<div class="mt-4">
  <a href="{% url 'academics:attendance_calendar' %}" class="btn btn-outline-secondary">
    <i class="bi bi-arrow-left"></i> Back to Calendar
  </a>
</div>

{% endblock academics_content %}
