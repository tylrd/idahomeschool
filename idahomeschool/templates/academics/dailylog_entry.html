{% extends "academics/base.html" %}
{% load static %}

{% block title %}Daily Log Entry{% endblock %}

{% block academics_content %}
<div class="flex justify-between items-center mb-3">
  <h1 class="text-3xl font-bold">Daily Log Entry</h1>
  <div class="flex gap-2">
    <a href="{% url 'academics:attendance_calendar' %}" class="btn btn-sm bg-secondary text-secondary-foreground">Calendar View</a>
    <a href="{% url 'academics:dailylog_list' %}" class="btn btn-sm bg-secondary text-secondary-foreground">All Logs</a>
  </div>
</div>

<!-- Student and Date Selection -->
<div class="mb-3">
  <section class="py-3">
    <form class="form grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="grid gap-2 md:col-span-2">
        <label for="student_select" class="text-sm font-semibold">Student</label>
        <select id="student_select" name="student_id"
        class="w-full"
                hx-get="{% url 'academics:dailylog_entry' %}"
                hx-target="#dailylog-form-container"
                hx-push-url="true"
                hx-include="#date_input"
                hx-trigger="change">
          {% for s in students %}
            <option value="{{ s.id }}" {% if s.id == student.id %}selected{% endif %}>{{ s.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="grid gap-2">
        <label for="date_input" class="text-sm font-semibold">Date</label>
        <input type="date"
               id="date_input"
               name="date"
               value="{{ entry_date|date:'Y-m-d' }}"
               hx-get="{% url 'academics:dailylog_entry' %}"
               hx-target="#dailylog-form-container"
               hx-push-url="true"
               hx-include="#student_select"
               hx-trigger="change">
      </div>
    </form>
  </section>
</div>

<!-- Daily Log Entry Form Container -->
<div id="dailylog-form-container"
     hx-on::after-swap="document.querySelectorAll('.sidebar a.active').forEach(link => { link.classList.remove('active'); link.removeAttribute('aria-current'); }); const dailyLogLink = document.querySelector('.sidebar a[href*=\'dailylog_entry\']'); if (dailyLogLink) { dailyLogLink.classList.add('active'); dailyLogLink.setAttribute('aria-current', 'page'); }">
  {% include "academics/partials/dailylog_entry_form.html" %}
</div>
{% endblock academics_content %}
